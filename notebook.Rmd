---
title: "ADS 503 Team 4: Predicting Article Shares"
output: html_notebook
---

# Load Data
```{r}
df <- read.csv("Datasets/OnlineNewsPopularity.csv")
dim(df)
```
The dataset has 39,644 samples and 61 variables. 

# Missing Data
```{r}
na.by.col <- apply(df, 2, function(x) sum(is.na(x)))
any(na.by.col > 0)
```
None of the variables are missing any data. 

# Define Target and Predictors
```{r}
df <- df[, names(df) != "url"] # drop the url column, which functions as a sample ID
y <- df$shares  # shares is the target variable 
X <- df[, names(df) != "shares"]
```

# Target Distribution
```{r}
summary(y)
hist(y)
boxplot(y)
```

The target distribution is highly right-skewed. Let's try log transforming it. 
```{r}
hist(log(y))
boxplot(log(y))
```

The log of the target is much less skewed. Let's apply the log transformation. 
```{r}
y <- log(y)
```


# Binary Predictors
```{r}
unique(apply(X, 2, typeof)) # check predictor data types 

is.binary <- function(x) { # function to check whether or not a variable is binary 
  n.unique <- length(unique(x))
  min <- min(x)
  max <- max(x)
  if (n.unique == 2 & min == 0 & max == 1) {
    return(TRUE)
  }
  else {
    return(FALSE)
  }
}

binary.cols <- names(X)[apply(X, 2, is.binary)]
X.binary <- X[, binary.cols]
X.non.binary <- X[, !names(X) %in% binary.cols]
binary.cols
```
All predictors are of data type double. 14 of them are binary variables. 

# Near-Zero Variance Predictors
```{r}
library(caret)
zero.var.cols <- nearZeroVar(X)
names(X)[zero.var.cols]
kw_min_max <- X[, "kw_min_max"]
hist(kw_min_max)
```

kw_min_max is the only predictor with near-zero variance. Let's remove it.
```{r}
X <- X[, names(X) != "kw_min_max"]
```

# Predictor Correlations
## Non-Binary Predictors
```{r}
library(corrplot)
cor.matrix <- cor(X.non.binary)
corrplot(
  cor.matrix, 
  method = "square", 
  type = "upper", 
  order = "hclust",
  tl.pos = "n"
)
high.cor <- findCorrelation(cor.matrix, cutoff = .75) # variables contributing to high pairwise correlations 
length(names(X.non.binary)[high.cor])
```

There are 8 non-binary predictors contributing to high pairwise correlations. Let's remove them to avoid multicolinearity issues. 
```{r}
X.non.binary <- X.non.binary[, -high.cor]
cor.matrix.filtered <- cor(X.non.binary)
corrplot(
  cor.matrix.filtered,
  method = "square",
  type = "upper",
  tl.pos = "n"
)
```

## Binary Predictors
```{r}
cor.matrix <- cor(X.binary)
corrplot(
  cor.matrix, 
  method = "square", 
  type = "upper", 
  order = "hclust"
)
high.cor <- findCorrelation(cor.matrix, cutoff = .75) # variables contributing to high pairwise correlations 
length(names(X.binary)[high.cor])
```

None of the binary predictors contribute to pairwise correlations greater than .75. However, is_weekend is redundant because it will always be true when weekday_is_saturday or weekday_is_sunday is true. Furthermore, there is a binary indicator for every day of the week, so we need to remove one to avoid the dummy variable trap. 

```{r}
X.binary <- X.binary[, !names(X.binary) %in% c("is_weekend", "weekday_is_sunday")]
```
Let's also check the channel variables for the dummy trap. 
```{r}
channels <- c(
  "data_channel_is_world",
  "data_channel_is_socmed",
  "data_channel_is_tech",
  "data_channel_is_bus",
  "data_channel_is_entertainment",
  "data_channel_is_lifestyle"
)
summary(apply(X[, channels], 1, sum)) # check if they always sum to 1 for every sample
```
They do not always sum to 1 for every sample, so they do not fall into the dummy variable trap. 
Let's update our master predictor matrix to only retain the non-redundant predictors. 
```{r}
cols.to.keep <- c(names(X.non.binary), names(X.binary))
X <- X[, names(X) %in% cols.to.keep] 
```

























